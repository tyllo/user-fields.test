(function(e){function t(t){for(var n,l,o=t[0],s=t[1],u=t[2],d=0,f=[];d<o.length;d++)l=o[d],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&f.push(a[l][0]),a[l]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);c&&c(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,o=1;o<r.length;o++){var s=r[o];0!==a[s]&&(n=!1)}n&&(i.splice(t--,1),e=l(l.s=r[0]))}return e}var n={},a={app:0},i=[];function l(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.m=e,l.c=n,l.d=function(e,t,r){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(r,n,function(t){return e[t]}.bind(null,n));return r},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/user-fields.test/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=s;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"2e27":function(e,t,r){"use strict";var n=r("4b3e"),a=r.n(n);a.a},"4b3e":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"nameValidator",(function(){return C})),r.d(n,"genderValidator",(function(){return w})),r.d(n,"dateValidator",(function(){return V}));r("e260"),r("e6cf"),r("cca6"),r("a79d");var a,i,l,o,s,u,c=r("2b0e"),d=r("289d"),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("AppLayout",{attrs:{id:"app"},scopedSlots:e._u([{key:"left",fn:function(){return[r("h2",{staticClass:"title"},[e._v("User form")]),r("UserForm",{attrs:{fileds:e.userFields},on:{submit:e.onSubmit},model:{value:e.userData,callback:function(t){e.userData=t},expression:"userData"}})]},proxy:!0},{key:"right",fn:function(){return[r("h2",{staticClass:"title"},[e._v("User data")]),r("pre",{staticStyle:{width:"400px"},domProps:{textContent:e._s(e.userData)}})]},proxy:!0}])})},p=[],m=r("786f"),v=r("dbff"),h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"hero"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container"},[r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-narrow"},[e._t("left")],2),r("div",{staticClass:"column is-narrow"},[e._t("right")],2)])])])])},b=[],g=r("2877"),y={},O=Object(g["a"])(y,h,b,!1,null,null,null),x=O.exports,_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ValidatorObserver",{ref:"validator"},[r("form",{staticClass:"user-form",attrs:{name:"user-form"},on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._l(e.form,(function(t,n){return[r("ValidatorProvider",{key:n,attrs:{validator:e.filedsMap[n].validator,value:t,name:e.filedsMap[n].field},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$error,i=t.$message;return[r("FormField",{key:n,attrs:{error:a,message:i,field:e.filedsMap[n]},on:{input:e.onChange},model:{value:e.form[n],callback:function(t){e.$set(e.form,n,t)},expression:"form[key]"}})]}}],null,!0)})]})),r("button",{staticStyle:{visibility:"hidden"},attrs:{type:"submit"}})],2)])},F=[],S=(r("7db0"),r("13d5"),r("07ac"),r("96cf"),r("1da1")),$=r("5530"),j=(r("caad"),r("a15b"),r("d3b7"),r("25f0"),r("2532"),r("ddb0"),function(e){var t=e.id,r=e.handler,n=r.bind(e);return n.id=t,n}),C=j({id:"nameValidator",handler:function(e){return e?/^[a-zа-я\s]+$/i.test(e)?"":this.messages.chars:this.messages.empty},messages:{empty:"Поле не должно быть пустым",chars:"Поле должно содержать только буквы"}}),w=j({id:"genderValidator",values:["male","female"],handler:function(e){var t=this.values.includes(e);return t?"":this.messages.oneOf(this.values)},messages:{oneOf:function(e){return"Поле должно содержать одно из значений [".concat(e.join(", "),"]")}}}),V=j({id:"dateValidator",handler:function(e){if(!e)return"";var t=new Date(e),r="Invalid Date"!==t.toString();return r?"":this.messages.invalidDate},messages:{invalidDate:"Поле должно быть валидной датой"}}),k=(r("c975"),r("45fc"),r("a434"),{name:"ValidatorObserver",provide:function(){return{$ValidatorObserver:{addChildren:this.addChildren,removeChildren:this.removeChildren}}},data:function(){return{children:[]}},computed:{error:function(){return this.children.some((function(e){return e.error}))},options:function(){return{$error:this.$error}}},methods:{addChildren:function(e){this.children.push(e)},removeChildren:function(e){var t=this.children.indexOf(e);this.children.splice(t,1)},isValid:function(){var e=this;return new Promise((function(t){e.$nextTick((function(){return t(!e.error)}))}))}},render:function(){return this.$scopedSlots.default(this.options)}}),E=k,D=Object(g["a"])(E,a,i,!1,null,null,null),A=D.exports,P={name:"ValidatorProvider",inject:{$ValidatorObserver:{default:null}},props:{validator:{type:Function},value:null},created:function(){var e;null===(e=this.$ValidatorObserver)||void 0===e||e.addChildren(this)},beforeDestory:function(){var e;null===(e=this.$ValidatorObserver)||void 0===e||e.RemoveChildren(this)},computed:{message:function(){var e=this.validator,t=this.value;return"function"===typeof e?e(t):""},error:function(){return!!this.message},options:function(){return{$error:this.error,$message:this.message}}},render:function(){return this.$scopedSlots.default(this.options)}},T=P,M=Object(g["a"])(T,l,o,!1,null,null,null),N=M.exports,R=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("FormFieldLabel",{attrs:{label:e.field.label,error:e.error,message:e.message}},[r("FormFieldIndex",e._g({attrs:{value:e.value,type:e.field.type,field:e.field}},e.$listeners))],1)},I=[],J=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-field",{attrs:{label:e.label,type:e.error?"is-danger":e.type,message:e.message}},[e._t("default")],2)},L=[],U={name:"FormFieldLabel",inheritAttrs:!1,props:{label:String,error:Boolean,type:String,message:String}},B=U,q=Object(g["a"])(B,J,L,!1,null,null,null),G=q.exports,H=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-checkbox",{attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}}})},K=[],X={name:"FormFieldCheckbox",inheritAttrs:!1,props:{value:Boolean}},z=X,Z=Object(g["a"])(z,H,K,!1,null,null,null),Q=Z.exports,W=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-datepicker",{attrs:{value:e.model,icon:"calendar-today"},on:{input:function(t){return e.$emit("input",t)}}})},Y=[],ee={name:"FormFieldDate",inheritAttrs:!1,props:{value:String},computed:{model:function(){var e=this.value;return e&&new Date(e)}}},te=ee,re=Object(g["a"])(te,W,Y,!1,null,null,null),ne=re.exports,ae=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-input",{attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}}})},ie=[],le={name:"FormFieldInput",inheritAttrs:!1,props:{value:String}},oe=le,se=Object(g["a"])(oe,ae,ie,!1,null,null,null),ue=se.exports,ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-select",{attrs:{value:e.value,expanded:""},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.field.meta.values,(function(t){return r("option",{key:t.label,domProps:{value:t.value,textContent:e._s(t.label)}})})),0)},de=[],fe={name:"FormFieldSelect",inheritAttrs:!1,props:{value:String,field:{type:Object,reuired:!0}}},pe=fe,me=Object(g["a"])(pe,ce,de,!1,null,null,null),ve=me.exports,he={CHECKBOX:"checkbox",STRING:"string",SELECT:"select",DATE:"date"},be=function(e){switch(e){case he.STRING:return ue;case he.SELECT:return ve;case he.DATE:return ne;case he.CHECKBOX:return Q;default:return console.warn('[App warn]: компонент <FormFieldIndex /> не поддерживает тип "'.concat(e,'"')),ue}},ge={name:"FormFieldIndex",functional:!0,props:{type:{type:String,required:!0}},render:function(e,t){return e(be(t.props.type),t.data,t.children)}},ye=ge,Oe=Object(g["a"])(ye,s,u,!1,null,null,null),xe=Oe.exports,_e={name:"FormField",components:{FormFieldLabel:G,FormFieldIndex:xe},props:{value:null,error:Boolean,message:String,field:{type:Object,required:!0}}},Fe=_e,Se=Object(g["a"])(Fe,R,I,!1,null,null,null),$e=Se.exports,je=Object.values(n),Ce={name:"UserForm",model:{prop:"data",event:"change"},components:{ValidatorObserver:A,ValidatorProvider:N,FormField:$e},props:{data:{type:Object,required:!0},fileds:{type:Array,required:!0}},data:function(){return{form:{}}},watch:{data:{immediate:!0,handler:"onReset"}},computed:{filedsMap:function(){return this.fileds.reduce((function(e,t){var r=je.find((function(e){var r=e.id;return r===t.validator}))||e.validator;return e[t.field]=Object($["a"])(Object($["a"])({},t),{},{validator:r}),e}),{})}},methods:{onReset:function(){var e=this.data,t=JSON.parse(JSON.stringify(e));this.form=t},onChange:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$refs.validator,t.next=3,r.isValid();case 3:n=t.sent,n&&e.$emit("change",e.form);case 5:case"end":return t.stop()}}),t)})))()},onSubmit:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$refs.validator,t.next=3,r.isValid();case 3:n=t.sent,n&&e.$emit("submit",e.form);case 5:case"end":return t.stop()}}),t)})))()}}},we=Ce,Ve=(r("2e27"),Object(g["a"])(we,_,F,!1,null,null,null)),ke=Ve.exports,Ee={name:"App",components:{AppLayout:x,UserForm:ke},data:function(){return{userData:m.data,userFields:v.data}},methods:{onSubmit:function(e){var t=JSON.stringify(e);alert(t)}}},De=Ee,Ae=(r("5c0b"),Object(g["a"])(De,f,p,!1,null,null,null)),Pe=Ae.exports;r("5abe");c["a"].use(d["a"]),c["a"].config.productionTip=!1,new c["a"]({render:function(e){return e(Pe)}}).$mount("#app")},"5c0b":function(e,t,r){"use strict";var n=r("9c0c"),a=r.n(n);a.a},"786f":function(e){e.exports=JSON.parse('{"data":{"name":"User Name","gender":"male","sub":"2020-03-04T13:40Z","is_active":true}}')},"9c0c":function(e,t,r){},dbff:function(e){e.exports=JSON.parse('{"data":[{"label":"Name","field":"name","type":"string","validator":"nameValidator"},{"label":"Gender","field":"gender","type":"select","validator":"genderValidator","meta":{"values":[{"label":"Male","value":"male"},{"label":"Female","value":"female"}]}},{"label":"Subscription","field":"sub","type":"date","validator":"dateValidator"},{"label":"Active","field":"is_active","type":"checkbox"}]}')}});
//# sourceMappingURL=app.46073c69.js.map